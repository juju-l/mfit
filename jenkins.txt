
echo 6b4eb32cb198ac4344fd436588a51ddcb2666926689a6b26962ab06c17b2411e > secret-file
curl -sO http://124.223.163.103:8091/jnlpJars/agent.jar
java -jar agent.jar -jnlpUrl http://124.223.163.103:8091/computer/agent/jenkins-agent.jnlp -secret @secret-file -workDir "/opt/build"



curl 'http://localhost:8091/computer/createItem' -H 'Connection: keep-alive' -H 'Cache-Control: max-age=0' -H 'Origin: http://localhost:8091' -H 'Upgrade-Insecure-Requests: 1' -H 'Content-Type: application/x-www-form-urlencoded' -H 'User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.87 Safari/537.36 SE 2.X MetaSr 1.0' -H 'Sec-Fetch-Dest: document' -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9' -H 'Sec-Fetch-Site: same-origin' -H 'Sec-Fetch-Mode: navigate' -H 'Sec-Fetch-User: ?1' -H 'Referer: http://localhost:8091/computer/new' -H 'Accept-Language: zh-CN,zh;q=0.9' -H 'Cookie: jenkins-timestamper-offset=-28800000; jenkins-timestamper=system; jenkins-timestamper-local=true; screenResolution=1280x1024; vipPromorunningtmr=; isvipretainend=; discount_free_trigger=; JSESSIONID.8ff62224=node0bhkicz600q9v19tv3w5xtqg3j7.node0; JSESSIONID.7e16b9cb=node01etazgntod8mjguyskx44lgki1.node0; remember-me=cm9vdDoxNjYxMTgzOTQ1MjYwOmY0MWI2ODNmYzgzZWQ5YWZlYzNiZDY2MTU2MDY1ZTcwYzMzNDIwYzdiNmNlOGI5M2U2MTRhY2ZkYjcwNDE5OGI' --data 'name=cc&mode=hudson.slaves.DumbSlave&from=&Submit=Create&Jenkins-Crumb=f5fdcc4161c7104a8dd28385843413c8dcbbb9e7c54e6b4df24627df70ed2813&json=%7B%22name%22%3A+%22cc%22%2C+%22mode%22%3A+%22hudson.slaves.DumbSlave%22%2C+%22from%22%3A+%22%22%2C+%22Jenkins-Crumb%22%3A+%22f5fdcc4161c7104a8dd28385843413c8dcbbb9e7c54e6b4df24627df70ed2813%22%7D' --compressed


curl 'http://localhost:8091/computer/doCreateItem' -H 'Connection: keep-alive' -H 'Cache-Control: max-age=0' -H 'Origin: http://localhost:8091' -H 'Upgrade-Insecure-Requests: 1' -H 'Content-Type: application/x-www-form-urlencoded' -H 'User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.87 Safari/537.36 SE 2.X MetaSr 1.0' -H 'Sec-Fetch-Dest: document' -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9' -H 'Sec-Fetch-Site: same-origin' -H 'Sec-Fetch-Mode: navigate' -H 'Sec-Fetch-User: ?1' -H 'Referer: http://localhost:8091/computer/createItem' -H 'Accept-Language: zh-CN,zh;q=0.9' -H 'Cookie: jenkins-timestamper-offset=-28800000; jenkins-timestamper=system; jenkins-timestamper-local=true; screenResolution=1280x1024; vipPromorunningtmr=; isvipretainend=; discount_free_trigger=; JSESSIONID.8ff62224=node0bhkicz600q9v19tv3w5xtqg3j7.node0; JSESSIONID.7e16b9cb=node01etazgntod8mjguyskx44lgki1.node0; remember-me=cm9vdDoxNjYxMTgzOTQ1MjYwOmY0MWI2ODNmYzgzZWQ5YWZlYzNiZDY2MTU2MDY1ZTcwYzMzNDIwYzdiNmNlOGI5M2U2MTRhY2ZkYjcwNDE5OGI' --data 'name=ag&_.nodeDescription=&_.numExecutors=1&_.remoteFS=%2Fopt%2Fbuild&_.labelString=&mode=NORMAL&stapler-class=hudson.slaves.JNLPLauncher&%24class=hudson.slaves.JNLPLauncher&_.workDirPath=&_.internalDir=remoting&_.tunnel=&stapler-class=hudson.slaves.CommandLauncher&%24class=hudson.slaves.CommandLauncher&oldCommand=&_.command=&stapler-class=hudson.plugins.sshslaves.SSHLauncher&%24class=hudson.plugins.sshslaves.SSHLauncher&_.host=&includeUser=false&_.credentialsId=&stapler-class=hudson.plugins.sshslaves.verifiers.KnownHostsFileKeyVerificationStrategy&%24class=hudson.plugins.sshslaves.verifiers.KnownHostsFileKeyVerificationStrategy&stapler-class=hudson.plugins.sshslaves.verifiers.ManuallyProvidedKeyVerificationStrategy&%24class=hudson.plugins.sshslaves.verifiers.ManuallyProvidedKeyVerificationStrategy&stapler-class=hudson.plugins.sshslaves.verifiers.ManuallyTrustedKeyVerificationStrategy&%24class=hudson.plugins.sshslaves.verifiers.ManuallyTrustedKeyVerificationStrategy&stapler-class=hudson.plugins.sshslaves.verifiers.NonVerifyingKeyVerificationStrategy&%24class=hudson.plugins.sshslaves.verifiers.NonVerifyingKeyVerificationStrategy&_.port=22&_.javaPath=&_.jvmOptions=&_.prefixStartSlaveCmd=&_.suffixStartSlaveCmd=&launchTimeoutSeconds=&maxNumRetries=&retryWaitTime=&tcpNoDelay=on&workDir=&stapler-class=hudson.slaves.RetentionStrategy%24Always&%24class=hudson.slaves.RetentionStrategy%24Always&stapler-class=hudson.slaves.SimpleScheduledRetentionStrategy&%24class=hudson.slaves.SimpleScheduledRetentionStrategy&stapler-class=hudson.slaves.RetentionStrategy%24Demand&%24class=hudson.slaves.RetentionStrategy%24Demand&stapler-class-bag=true&type=hudson.slaves.DumbSlave&Jenkins-Crumb=f5fdcc4161c7104a8dd28385843413c8dcbbb9e7c54e6b4df24627df70ed2813&json=%7B%22name%22%3A+%22ag%22%2C+%22nodeDescription%22%3A+%22%22%2C+%22numExecutors%22%3A+%221%22%2C+%22remoteFS%22%3A+%22%2Fopt%2Fbuild%22%2C+%22labelString%22%3A+%22%22%2C+%22mode%22%3A+%22NORMAL%22%2C+%22%22%3A+%5B%22hudson.slaves.JNLPLauncher%22%2C+%220%22%5D%2C+%22launcher%22%3A+%7B%22stapler-class%22%3A+%22hudson.slaves.JNLPLauncher%22%2C+%22%24class%22%3A+%22hudson.slaves.JNLPLauncher%22%2C+%22workDirSettings%22%3A+%7B%22disabled%22%3A+false%2C+%22workDirPath%22%3A+%22%22%2C+%22internalDir%22%3A+%22remoting%22%2C+%22failIfWorkDirIsMissing%22%3A+false%7D%2C+%22webSocket%22%3A+false%2C+%22tunnel%22%3A+%22%22%2C+%22oldCommand%22%3A+%22%22%7D%2C+%22retentionStrategy%22%3A+%7B%22stapler-class%22%3A+%22hudson.slaves.RetentionStrategy%24Always%22%2C+%22%24class%22%3A+%22hudson.slaves.RetentionStrategy%24Always%22%7D%2C+%22nodeProperties%22%3A+%7B%22stapler-class-bag%22%3A+%22true%22%7D%2C+%22type%22%3A+%22hudson.slaves.DumbSlave%22%2C+%22Jenkins-Crumb%22%3A+%22f5fdcc4161c7104a8dd28385843413c8dcbbb9e7c54e6b4df24627df70ed2813%22%7D&Submit=%E4%BF%9D%E5%AD%98' --compressed




curl --location --request POST 'http://124.223.163.103:8091/computer/agent/doDelete' \
--header 'Content-Type: application/x-www-form-urlencoded' \
--header 'crumb: 43c0ec423d85f0f302a70326215f31bc27651b278edda85539121499e5e57095' \
--header 'Authorization: Basic cm9vdDo2NTQzMjE=' \
--header 'Cookie: JSESSIONID.c7d559bd=node011ronm67zeqtcil9x2vn4sy1213.node0' \
--data-urlencode 'Jenkins-Crumb=43c0ec423d85f0f302a70326215f31bc27651b278edda85539121499e5e57095' \
--data-urlencode 'json={"Jenkins-Crumb":"43c0ec423d85f0f302a70326215f31bc27651b278edda85539121499e5e57095"}' \
--data-urlencode 'Submit=Yes'



curl --location --request POST 'http://124.223.163.103:8091/computer/doCreateItem' \
--header 'Content-Type: application/x-www-form-urlencoded' \
--header 'Referer: http://localhost:8091/computer/createItem' \
--header 'Cookie: jenkins-timestamper-offset=-28800000; jenkins-timestamper=system; jenkins-timestamper-local=true; screenResolution=1280x1024; vipPromorunningtmr=; isvipretainend=; discount_free_trigger=; JSESSIONID.7e16b9cb=node0y0f0iio51t581azru5y12n3zw9.node0' \
--data-urlencode 'name=agent' \
--data-urlencode 'Jenkins-Crumb=f5fdcc4161c7104a8dd28385843413c8dcbbb9e7c54e6b4df24627df70ed2813' \
--data-urlencode 'json={"name":"agent","nodeDescription":"","numExecutors":"1","remoteFS":"/opt/jks_build","labelString":"tst","mode":"NORMAL","":["hudson.slaves.JNLPLauncher","0"],"launcher":{"stapler-class":"hudson.slaves.JNLPLauncher","$class":"hudson.slaves.JNLPLauncher","workDirSettings":{"disabled":false,"workDirPath":"","internalDir":"remoting","failIfWorkDirIsMissing":false},"webSocket":false,"tunnel":"","oldCommand":""},"retentionStrategy":{"stapler-class":"hudson.slaves.RetentionStrategy$Always","$class":"hudson.slaves.RetentionStrategy$Always"},"nodeProperties":{"stapler-class-bag":"true"},"type":"hudson.slaves.DumbSlave","Jenkins-Crumb":"f5fdcc4161c7104a8dd28385843413c8dcbbb9e7c54e6b4df24627df70ed2813"}'


curl --location --request GET 'http://124.223.163.103:8091/crumbIssuer/api/json?pretty=true' \
--header 'Authorization: Basic cm9vdDo2NTQzMjE='

